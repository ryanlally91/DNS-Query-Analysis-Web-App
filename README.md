# DNS-Query-Analysis-Web-App

This web app was developed in order to assess the likliehood that a domain is malicious, in this case, generated by a DGA (Domain Generation Algorithim).
The application is split into three main components, each of which operate independantly of each other, Whitelist, 'Baby Domain Analysis' and Entropy Analysis

The following Technologes Technologies Used:
- Tomcat
- MySQL
- JSP

Whitelist:
- Query a domain against a database whitelist of the top 1000 domain names (as collated by Cisco Umbrella Organization) If domain not     present, user-alert issued.
- Ability to add domains to the whitelist

If development was to continue with this component, a larger data set would be required and one which is non-static and is updated daily.
 
Entropy:
- The user can enter a domain and retrieve an entropy value – a user-alert is issued if the value exceeds that of the designated threshold
- The Shannon entropy formula has been sourced elsewhere, and is cited. 
- A Shannon entropy threshold of 3.69 was decided on. Three lists of 20 (60 in total) known malicious domains were assessed for their entropy values. The DGAs responsible for these respective lists were Crypotolocker, GameOver Zues, and New GameOver Zues (all sourced from Github). The entropy values were then calculated for the top 60 whitelist domains. The FAR (malicious scores falling below the threshold/ all malicious scores) and FRR (genuine scores exceeding the threshold/ all genuine scores) for both malicious and non-malicious lists were then calculated for a few different entropy values. A (CER) crossover-error rate was then decided to be an adequate threshold. This is the point at which the FAR and the FRR are equal, it is often used for authentication algorithims in biometrics and as such I thought it was suitable. This is how the value 3.69 was decided upon.

The literature on appropriate entropy thresholds for malicious domains was scarce as many seem to take into account many other factors as well (Jaccard coefficents, edit distances etc). Perhaps further research in to some of these factors could be interesting. Distribution of alphanumeric bigrams and trigrams also could play a part in this, though apparently many of the new malware employs DGAs which produce 'pronouncable' domains. However, used in conjunction with other forms of analysis it may be useful.
 
Baby Domains:

- The final set up is a table in the DB with dummy domains and dummy registration dates. The user can query one of these dummy sites and be alerted if the registration date is in the last 2 days, otherwise the site is noted as, ‘verified’. A couple of different SQL queries were assessed here for the best throughput time. 
- An API which checks the associated registrar of a given domain for its birthdate would be desired if this component was to be pursued.
 
Ultimately it seems like, from my time looking at the topic, layers and layers of different types of analysis are essential to assess the likelihood that a domain is malicious. None of the given modules used independently of each other could be considered a 'litmus test'.
